library("SNFtool")
l_data=read.csv("Documents/MS/ML_OMICS/SNF_standard/luminex.csv")
#-----------For Luminex----
l_data=read.csv("luminex.csv")
View(l_data)
l_diss=dist(l_data[,-1])
?affinityMatrix
?dist
l_sim=affinityMatrix(l_diss,K=20,sigma=0.5)
l_sim
l_diss
l_diss=dist(l_data[,-1],method="euclidean",diag=TRUE,upper=TRUE)
l_sim=affinityMatrix(l_diss,K=20,sigma=0.5)
l_diss
?affinityMatrix
l_sim=affinityMatrix(l_diss,K=22,sigma=0.1)
l_sim=affinityMatrix(l_diss,K=22,sigma=0.5)
?affinityMatrix
Dist1 = (dist2(as.matrix(l_data),as.matrix(l_data)))^(1/2)
?dist2
dist2(as.matrix(l_data),as.matrix(l_data))
Dist1 = (dist2(as.matrix(l_data[,-1]),as.matrix(l_data[,-1])))^(1/2)
dist2(as.matrix(l_data),as.matrix(l_data))
l_sim=affinityMatrix(Dist1,K=22,sigma=0.5)
l_sim
l_diss
l_sim1=affinityMatrix(as.matrix(l_diss),K=22,sigma=0.5)
l_sim-l_sim1
sum(l_sim-l_sim1)
sum(l_sim-l_sim1)
estimateNumberOfClustersGivenGraph(l_sim)
estimateNumberOfClustersGivenGraph(W)
W=l_sim
estimateNumberOfClustersGivenGraph(W)
displayClusters(W, spectralClustering(W, K = 2))
displayClusters(W, spectralClustering(W, K = 5))
displayClusters(W, spectralClustering(W, K = 4))
displayClusters(W, spectralClustering(W, K = 5))
C=5
labels=spectralClustering(W,C)
write.csv(W,"merged_matrix.csv")
write.csv(labels,"labels.csv")
C=2
labels=spectralClustering(W,C)
write.csv(W,"merged_matrix.csv")
write.csv(labels,"labels.csv")
displayClusters(W, spectralClustering(W, K = 2))
C=4
labels=spectralClustering(W,C)
write.csv(W,"merged_matrix.csv")
write.csv(labels,"labels.csv")
C=2
labels=spectralClustering(W,C)
write.csv(W,"merged_matrix.csv")
write.csv(labels,"labels.csv")
q()
library("SNFtool")
library("vegan")
#library("RColorBrewer")
b_data=read.csv("Documents/MS/ML_OMICS/SNF_standard/bacteria.csv")
f_data=read.csv("Documents/MS/ML_OMICS/SNF_standard/fungi.csv")
#library("RColorBrewer")
b_data=read.csv("bacteria.csv")
f_data=read.csv("fungi.csv")
#l_data=read.csv("Documents/MS/ML_OMICS/SNF_standard/luminex.csv")
b_dsim=vegdist(b_data[,-1],method='bray',diag=TRUE,upper=TRUE)
f_dsim=vegdist(f_data[,-1],method='bray',diag=TRUE,upper=TRUE)
#l_dsim=vegdist(l_data[,-1],method='bray',diag=TRUE,upper=TRUE)
W1=(as.matrix(b_dsim)-1)*-1
W2=(as.matrix(f_dsim)-1)*-1
W = SNF(list(W1,W2),23,15)
estimateNumberOfClustersGivenGraph(W)
displayClusters(W, spectralClustering(W, K = 2))
C=2
#W=x
labels=spectralClustering(W,C)
write.csv(W,"/home/jhome/Documents/MS/ML_OMICS/SNF_standard/merged_matrix.csv")
write.csv(labels,"/home/jhome/Documents/MS/ML_OMICS/SNF_standard/labels.csv")
q()
library("SNFtool")
library("vegan")
#library("RColorBrewer")
b_data=read.csv("bacteria.csv")
f_data=read.csv("fungi.csv")
#l_data=read.csv("Documents/MS/ML_OMICS/SNF_standard/luminex.csv")
b_dsim=vegdist(b_data[,-1],method='bray',diag=TRUE,upper=TRUE)
f_dsim=vegdist(f_data[,-1],method='bray',diag=TRUE,upper=TRUE)
#l_dsim=vegdist(l_data[,-1],method='bray',diag=TRUE,upper=TRUE)
W1=(as.matrix(b_dsim)-1)*-1
W2=(as.matrix(f_dsim)-1)*-1
estimateNumberOfClustersGivenGraph(W)
estimateNumberOfClustersGivenGraph(W1)
C=2
#W=x
labels=spectralClustering(W,C)
#W=x
labels=spectralClustering(W1,C)
write.csv(W1,"matrix_bacteria.csv")
write.csv(W1,"labels_bacteria.csv")
library("SNFtool")
library("vegan")
#library("RColorBrewer")
b_data=read.csv("bacteria.csv")
f_data=read.csv("fungi.csv")
#l_data=read.csv("Documents/MS/ML_OMICS/SNF_standard/luminex.csv")
b_dsim=vegdist(b_data[,-1],method='bray',diag=TRUE,upper=TRUE)
f_dsim=vegdist(f_data[,-1],method='bray',diag=TRUE,upper=TRUE)
#l_dsim=vegdist(l_data[,-1],method='bray',diag=TRUE,upper=TRUE)
W1=(as.matrix(b_dsim)-1)*-1
W2=(as.matrix(f_dsim)-1)*-1
#W3=(as.matrix(l_dsim)-1)*-1
x=W2
C=2
#W=x
labels=spectralClustering(W,C)
#W=x
labels=spectralClustering(W1,C)
library("SNFtool")
library("vegan")
#library("RColorBrewer")
b_data=read.csv("bacteria.csv")
f_data=read.csv("fungi.csv")
#l_data=read.csv("Documents/MS/ML_OMICS/SNF_standard/luminex.csv")
b_dsim=vegdist(b_data[,-1],method='bray',diag=TRUE,upper=TRUE)
f_dsim=vegdist(f_data[,-1],method='bray',diag=TRUE,upper=TRUE)
#l_dsim=vegdist(l_data[,-1],method='bray',diag=TRUE,upper=TRUE)
W1=(as.matrix(b_dsim)-1)*-1
W2=(as.matrix(f_dsim)-1)*-1
C=2
#W=x
labels=spectralClustering(W,C)
#W=x
labels=spectralClustering(W1,C)
write.csv(labels,"bacteria_labels.csv")
